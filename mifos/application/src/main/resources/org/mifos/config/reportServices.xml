<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

    <bean id="cacheManager" class="org.springframework.cache.ehcache.EhCacheManagerFactoryBean">
        <property name="configLocation">
            <value>classpath:org/mifos/config/resources/ehcache.xml</value>
        </property>
    </bean>

    <bean id="cacheProviderFacade" class="org.springmodules.cache.provider.ehcache.EhCacheFacade">
        <property name="cacheManager" ref="cacheManager" />
    </bean>

    <bean id="collectionSheetService" class="org.mifos.reports.business.service.BirtCollectionSheetService" />
    <bean id="officeBusinessService" class="org.mifos.customers.office.business.service.OfficeBusinessService" />
    <bean id="personnelBusinessService" class="org.mifos.customers.personnel.business.service.PersonnelBusinessService" />

    <bean id="customerBusinessService" class="org.mifos.customers.business.service.CustomerBusinessService" />
    <bean id="accountBusinessService" class="org.mifos.accounts.business.service.AccountBusinessService" />
    <bean id="savingsPrdBusinessService" class="org.mifos.accounts.productdefinition.business.service.SavingsPrdBusinessService" />
    <bean id="loanPrdBusinessService" class="org.mifos.accounts.productdefinition.business.service.LoanPrdBusinessService" />
    <bean id="branchReportPersistence" class="org.mifos.reports.branchreport.persistence.BranchReportPersistence" />

    <bean id="branchCashConfirmationReportPersistence" class="org.mifos.reports.cashconfirmationreport.persistence.BranchCashConfirmationReportPersistence" />

    <bean id="genericDao" class="org.mifos.accounts.savings.persistence.GenericDaoHibernate" />

    <bean id="selectionItemDao" class="org.mifos.reports.business.dao.SelectionItemDaoHibernate">
        <constructor-arg ref="genericDao" />
    </bean>

    <bean id="personnelDao" class="org.mifos.customers.personnel.persistence.PersonnelDaoHibernate" >
        <constructor-arg ref="genericDao" />
    </bean>

    <bean id="reportProductOfferingService" class="org.mifos.reports.business.service.ReportProductOfferingService">
        <constructor-arg ref="loanPrdBusinessService" />
        <constructor-arg ref="savingsPrdBusinessService" />
        <constructor-arg>
            <value>
                classpath:org/mifos/reports/resources/CollectionSheetReport.properties
            </value>
        </constructor-arg>
    </bean>

    <bean id="cascadingReportParameterService" class="org.mifos.reports.business.service.CascadingReportParameterService">
        <constructor-arg index="0" type="org.mifos.reports.business.dao.SelectionItemDao" ref="reportParameterServiceProxy" />
        <constructor-arg index="1" ref="personnelDao" />
    </bean>

    <bean id="reportParameterServiceProxy" class="org.springmodules.cache.interceptor.proxy.CacheProxyFactoryBean">
        <property name="cacheProviderFacade" ref="cacheProviderFacade" />
        <property name="cachingModels">
            <props>
                <prop key="get*">
                    cacheName=org.mifos.reports.business.service.cache
                </prop>
            </props>
        </property>
        <property name="flushingModels">
            <props>
                <prop key="invalidate">
                    cacheNames=org.mifos.reports.business.service.cache
                </prop>
            </props>
        </property>
        <property name="target" ref="selectionItemDao" />
    </bean>

    <bean id="defaultCollectionSheetReportService" class="org.mifos.reports.business.service.BirtCollectionSheetReportService">
        <constructor-arg ref="collectionSheetService" />
        <constructor-arg ref="reportProductOfferingService" />
    </bean>

    <bean id="collectionSheetReportService" factory-method="decorate" class="org.mifos.framework.business.service.ServiceDecoratorFactory">
        <constructor-arg type="org.mifos.reports.business.service.ICollectionSheetReportService" ref="defaultCollectionSheetReportService" />
        <constructor-arg>
            <bean
                class="org.mifos.framework.components.logger.ServiceActivityLogger">
                <constructor-arg value="CollectionSheetReportService" />
            </bean>
        </constructor-arg>
    </bean>

    <bean name="branchReportConfigService" class="org.mifos.reports.business.service.BranchReportConfigService">
        <constructor-arg>
            <value>
                classpath:org/mifos/reports/resources/ProgressReport.properties
            </value>
        </constructor-arg>
    </bean>

    <bean name="hoCashConfirmationConfigService" class="org.mifos.reports.business.service.HOCashConfirmationConfigService">
        <constructor-arg>
            <value>
                classpath:org/mifos/reports/resources/HOCashConfirmationReport.properties
            </value>
        </constructor-arg>
    </bean>

    <bean name="cashConfirmationConfigService" class="org.mifos.reports.business.service.CashConfirmationConfigService">
        <constructor-arg>
            <value>
                classpath:org/mifos/reports/resources/BranchCashConfirmationReport.properties
            </value>
        </constructor-arg>
    </bean>

    <bean name="branchReportService" class="org.mifos.reports.business.service.BranchReportService">
        <constructor-arg ref="officeBusinessService" />
        <constructor-arg ref="personnelBusinessService" />
        <constructor-arg ref="branchReportPersistence" />
    </bean>

    <bean name="branchCashConfirmationReportService" class="org.mifos.reports.business.service.BranchCashConfirmationReportService">
        <constructor-arg ref="branchCashConfirmationReportPersistence" />
        <constructor-arg ref="officeBusinessService" />
    </bean>
</beans>